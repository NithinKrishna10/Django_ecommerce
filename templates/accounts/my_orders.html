{% extends 'indexhome.html' %}


{% block content %}

<section class="section-conten padding-y bg" style="margin-top: 5%;">

{% include 'includes/alerts.html' %}
<div class="container">
	<div class="row">
	{% include 'includes/dashboard_sidebar.html' %}
	<main class="col-md-9">
		<article class="card">
		<header class="card-header">
			<strong class="d-inline-block mr-3">Your order history</strong>

		</header>
		<div class="card-body">
			<div class="row">
			<div class="col-md-12">
				<table class="table table-hover">
				  <thead>
				    <tr>
				      <th scope="col">Order #</th>
				      <th scope="col">Billing Name</th>
				      <th scope="col">Phone</th>
				      <th scope="col">Order Total</th>
					  <th scope="col">Date</th>
					  <th scope="col">Status</th>
					  <th scope="col">Payment</th>
					  <th scope="col">Cancel</th>
				    </tr>
				  </thead>
				  <tbody>
						{% for order in orders %}
				    <tr>
						<th><img class="img-fluid" src="{{ orders.product.images.url }}" alt=""></th>
				      <th scope="row"><a href="{% url 'order_detail' order.id %}">{{order.order_number}}</a></th>
				      <td>{{order.user.full_name}}</td>
				      <td>{{order.Shipping.phone}}</td>
				      <td>${{order.order_total}}</td>
					   <td>{{order.created_at}}</td>
					   <td>{{order.status}}</td>
					   <td>{{order.payment_mode}}</td>
					   <td>
						<!-- <form action="{% url 'cancel_order' order.id %}" method="POST">  -->
							{% csrf_token %}
							<input type="hidden" class="can" value="{{order.id}}">
							{% if order.status == 'Cancelled'  %}
							<p>order Cancelled</p>
							{% else %}
							<button type="submit" id="cancel-btn"  class="btn btn-outline-danger ">Cancel</button>
							{% endif %}
						  <!-- </form> -->
					   </td>
				    </tr>
				{% endfor %}

				  </tbody>
				</table>
			</div>

			</div> <!-- row.// -->
		</div> <!-- card-body .// -->

		</article> <!-- order-group.// -->
	</main>
</div> <!-- row.// -->
</div>


</section>

<script>
    function showConfirm() {
      var confirmed = confirm("Are you sure you want to Block this User?");
  
      if (confirmed) {
          // Perform the action if the user clicks "OK"
      } else {
          // Cancel the action if the user clicks "Cancel"
      }
  }


  function confirmDelete() {
	swal({
		title: "Are you sure?",
		text: "Once deleted, you will not be able to recover this imaginary file!",
		icon: "warning",
		buttons: true,
		dangerMode: true,
	  })
	  .then((willDelete) => {
		if (willDelete) {
			var order_id = ('.can').val();
			var token = $("[name='csrfmiddlewaretoken']").val();
			$.ajax({
			
				method: 'POST',
				
				url: '/accounts=/cancelOrderS',
			   
			   // data: data,
				data: {  'order_id': 'order_id',  csrfmiddlewaretoken : token, },
			   
				success: function (response) {
				   
						console.log('order placed successfully')
						window.location.href = '/my_orders'
				  
				}
			})
		  swal("Poof! Your imaginary file has been deleted!", {
			icon: "success",
		  });
		} else {
		  swal("Your imaginary file is safe!");
		}
	  });
}

  
  </script>

{% endblock %}